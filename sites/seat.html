<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wedding Seat Selector</title>
<link rel="stylesheet" href="styles/seat.css">
</head>
<body>
<div class="table-container">
    <canvas id="seats"></canvas>
</div>
<script>
const canvas = document.getElementById("seats");
const ctx = canvas.getContext("2d");

const seatSize = Math.min(window.innerWidth / 15, 50); // Adjust seat size to fit screen width
const seatGap = 1.25;

const seatRows = 4;
const seatColumns = 8; // 4 seats on each side of the aisle
const busLength = (seatRows * seatSize * seatGap) + (seatSize * 2) - seatSize * (seatGap - 1);
const busWidth = (seatColumns * seatSize) + (seatSize * 2); // Additional spacing for aisle

canvas.width = busWidth + 20;
canvas.height = busLength + 20;

const seats = new Array(seatRows * seatColumns).fill(null);

function roundRect(x, y, width, height, radius, fill = false) {
    ctx.beginPath();
    ctx.moveTo(x + radius, y);
    ctx.lineTo(x + width - radius, y);
    ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
    ctx.lineTo(x + width, y + height - radius);
    ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
    ctx.lineTo(x + radius, y + height);
    ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
    ctx.lineTo(x, y + radius);
    ctx.quadraticCurveTo(x, y, x + radius, y);
    ctx.closePath();
    if (fill) {
        ctx.fill();
    } else {
        ctx.stroke();
    }
}

function drawSeats() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    let seatNumber = 1;
    for (let row = 0; row < seatRows; row++) {
        for (let col = 0; col < seatColumns; col++) {
            // Adding a gap for the aisle between the 4th and 5th seat
            const x = col * seatSize + 10 + (col >= 4 ? seatSize * 2 : 0); // Creating an aisle space
            const y = row * seatSize * seatGap + seatSize * 2 + 10;

            ctx.strokeStyle = "gray";
            ctx.lineWidth = 2;
            roundRect(x, y, seatSize, seatSize, 5);

            const index = row * seatColumns + col;
            if (seats[index]) {
                ctx.fillStyle = "#b9dbcb";
                roundRect(x, y, seatSize, seatSize, 5, true);
                ctx.fillStyle = "black";
                ctx.font = `${seatSize / 4}px Arial`;
                ctx.fillText(seats[index], x + seatSize / 2, y + seatSize / 2, seatSize);
            } else {
                ctx.fillStyle = "grey";
                ctx.font = `${seatSize / 4}px Arial`;
                ctx.fillText(seatNumber, x + seatSize / 2, y + seatSize / 2, seatSize);
            }
            seatNumber++;
        }
    }
}

canvas.addEventListener('click', function(event) {
    const rect = canvas.getBoundingClientRect();
    const x = event.clientX - rect.left;
    const y = event.clientY - rect.top;
    selectSeat(x, y);
});

function selectSeat(x, y) {
    const row = Math.floor((y - 10 - seatSize * 2) / (seatSize * seatGap));
    const col = Math.floor((x - 10) / seatSize);
    if (col >= 4) col -= 1; // Adjust for the aisle gap
    const index = row * seatColumns + col;
    if (row >= 0 && row < seatRows && col >= 0 && col < seatColumns && col != 4) { // Skip interaction for the aisle gap
        const userName = prompt("Please enter your name");
        if (userName) {
            seats[index] = userName; // Save the user's name to the selected seat
            drawSeats(); // Redraw the seats to update the canvas
        }
    }
}

drawSeats(); // Initial draw of the seats
</script>
</body>
</html>
